<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tracking Pengiriman | SITTA</title>
    <link rel="stylesheet" href="../css/tracking.css" />
    <link rel="stylesheet" href="../css/dashboard.css" />
  </head>
  <body>
    <!-- NAVBAR -->
    <nav class="navbar">
      <ul>
        <li><a href="dashboard.html">Dashboard</a></li>
        <li><a href="stok.html">Informasi Bahan Ajar</a></li>
        <li><a href="tracking.html" class="active">Tracking Pengiriman</a></li>
        <li class="dropdown">
          <button class="dropbtn" onclick="toggleDropdown()">Laporan â–¾</button>
          <div class="dropdown-content" id="laporanDropdown">
            <a href="#">Monitoring Progress DO Bahan Ajar</a>
            <a href="#">Rekap Bahan Ajar</a>
          </div>
        </li>
        <li class="right">
          <a href="login.html" class="logout-btn">Logout</a>
        </li>
      </ul>
    </nav>

    <!-- HEADER -->
    <header class="tracking-header">
      <h2>Tracking Pengiriman Bahan Ajar</h2>
    </header>

    <!-- VUE APP -->
    <main id="app" class="tracking-container">
      <!-- ğŸ” PENCARIAN DO -->
<div class="search-section">
  <label for="noDO">No. DO/Billing</label>
  <div class="input-group">
    <input type="text" v-model="inputDO" placeholder="DO2025-001" />
    <button @click="cariDO">Lacak</button>   <!-- HARUS ADA @click -->
  </div>
</div>


      <!-- HASIL TRACKING -->
      <div v-if="hasil" class="tracking-result">
        <div class="tracking-card">
          <h3>{{ hasil.nama }}</h3>
          <p><strong>Nomor:</strong> {{ hasil.noDO }}</p>
          <p>{{ hasil.asal }} âœ {{ hasil.tujuan }}</p>
          <p>{{ hasil.alamat }}</p>
          <small>{{ hasil.tanggal }} {{ hasil.waktu }}</small>
        </div>

        <h4>Status Perjalanan:</h4>
        <div class="timeline">
          <div
            v-for="(step,i) in hasil.perjalanan"
            :key="i"
            class="timeline-item"
          >
            <p><strong>{{ step.keterangan }}</strong></p>
            <span>{{ step.tanggal }} {{ step.waktu }}</span>
          </div>
        </div>
      </div>
      <p v-else-if="inputDO" class="not-found">âŒ Nomor DO tidak ditemukan</p>

      <hr />

      <!-- FORM INPUT DO BARU -->
<h3>ğŸ“¦ Tambah Pengiriman Baru</h3>
<div class="form-container">

  <div class="input-row">
    <label>NIM Mahasiswa</label>
    <input type="text" v-model="newDO.nim" placeholder="Masukkan NIM" />
  </div>

  <div class="input-row">
    <label>Nama Mahasiswa</label>
    <input type="text" v-model="newDO.nama" placeholder="Nama Lengkap" />
  </div>

  <!-- EKSPEDISI -->
  <div class="input-row">
    <label>Ekspedisi</label>
    <select v-model="newDO.ekspedisi">
      <option value="">-- Pilih Ekspedisi --</option>
      <option v-for="e in ekspedisiList" :key="e">{{ e }}</option>
    </select>
  </div>

  <!-- PAKET -->
  <div class="input-row">
    <label>Paket Bahan Ajar</label>
    <select v-model="newDO.paket">
      <option value="">-- Pilih Paket Bahan Ajar --</option>
      <option v-for="p in paketList" :key="p.kode" :value="p.kode">
        {{ p.kode }} - {{ p.nama }}
      </option>
    </select>
  </div>

  <!-- DETAIL PAKET OTOMATIS -->
  <div class="detail-paket" v-if="paketDipilih">
    <p><strong>ğŸ“˜ Isi Paket:</strong></p>
    <ul>
      <li v-for="item in paketDipilih.isi" :key="item">{{ item }}</li>
    </ul>
    <p><strong>ğŸ’° Harga Total:</strong> Rp {{ paketDipilih.harga }}</p>
  </div>

  <!-- TANGGAL -->
  <div class="input-row">
    <label>Tanggal Kirim</label>
    <input type="date" v-model="newDO.tanggalKirim" />
  </div>

  <button @click="tambahTracking" class="btn-primary">â• Simpan DO</button>
</div>


      <!-- ğŸ“„ LIST SEMUA DATA -->
<h3>ğŸ“„ Daftar Semua Pengiriman</h3>

<table v-if="dataTracking.length > 0" class="table-do modern-table">
  <thead>
    <tr>
      <th>No DO</th>
      <th>NIM</th>
      <th>Nama</th>
      <th>Ekspedisi</th>
      <th>Total Harga</th>
      <th>Tanggal Kirim</th>
    </tr>
  </thead>
  <tbody>
    <tr v-for="pengiriman in dataTracking" :key="pengiriman.noDO">
      <td>{{ pengiriman.noDO }}</td>
      <td>{{ pengiriman.nim }}</td>
      <td>{{ pengiriman.nama }}</td>
      <td>{{ pengiriman.ekspedisi }}</td>
      <td>Rp {{ pengiriman.totalHarga || '-' }}</td>
      <td>{{ pengiriman.tanggal }}</td>
    </tr>
  </tbody>
</table>

<p v-else class="no-data">Belum ada data pengiriman.</p>

    </main>

    <!-- SCRIPT URUTAN PALING BENAR -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Vue dulu -->
    <script src="../js/paketBahanAjar.js"></script>
    <!-- DATA -->
    <script src="../js/tracking-app.js"></script>
    <!-- Vue logic -->
    <script src="../js/script.js"></script>
    <!-- Navbar -->
  </body>
</html>
